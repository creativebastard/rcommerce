# Cargo configuration for cross-compilation
# Uses cargo-zigbuild for cross-compilation without Docker

[build]
# Default target for local builds (Apple Silicon)
target = "aarch64-apple-darwin"

# Enable SQLx offline mode for builds
[env]
SQLX_OFFLINE = "true"

# Target-specific linker configurations (used by cargo-zigbuild)
[target.x86_64-unknown-linux-musl]
# MUSL targets create fully static binaries
rustflags = ["-C", "target-feature=+crt-static"]

[target.aarch64-unknown-linux-musl]
rustflags = ["-C", "target-feature=+crt-static"]

[target.armv7-unknown-linux-gnueabihf]
# ARMv7 settings for embedded Linux
linker = "arm-linux-gnueabihf-gcc"

# For FreeBSD cross-compilation
[target.x86_64-unknown-freebsd]
# Uses system clang via zig

# For NetBSD cross-compilation
[target.x86_64-unknown-netbsd]
# Uses system clang via zig

# Profile overrides for size optimization
[profile.release-lto]
inherits = "release"
lto = "fat"
codegen-units = 1
strip = true
opt-level = "z"

[profile.release-size]
inherits = "release"
opt-level = "z"
lto = true
strip = true
